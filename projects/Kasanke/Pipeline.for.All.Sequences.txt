makecontigs.pbs
#!/bin/bash
#PBS -q standard_16
#PBS -l walltime=48:00:00
#PBS -l nodes=4:ppn=16
#PBS -j oe
#PBS -m e
#PBS -M cpkasanke@alaska.edu
cd $PBS_O_WORKDIR
module load mothur/1.35.1.nompi
mothur "#make.contigs(file=stability.files, processors=16)"

Total of all groups is 33070130

Output File Names:
stability.trim.contigs.fasta
stability.contigs.qual
stability.contigs.report
stability.scrap.contigs.fasta
stability.scrap.contigs.qual
stability.contigs.groups


summary.seqs
#!/bin/bash
#PBS -q standard_16
#PBS -l walltime=48:00:00
#PBS -l nodes=4:ppn=16
#PBS -j oe
#PBS -m e
#PBS -M cpkasanke@alaska.edu
cd $PBS_O_WORKDIR
module load mothur/1.35.1.nompi
mothur "#summary.seqs(fasta=stability.trim.contigs.fasta, processors=16)"

Using 16 processors.

                Start   End     NBases  Ambigs  Polymer NumSeqs
Minimum:        1       241     241     0       3       1
2.5%-tile:      1       252     252     0       3       826754
25%-tile:       1       253     253     0       4       8267533
Median:         1       253     253     0       5       16535066
75%-tile:       1       253     253     0       6       24802598
97.5%-tile:     1       264     264     9       6       32243377
Maximum:        1       500     500     113     250     33070130
Mean:   1       256.505 256.505 0.914029        4.86067
# of Seqs:      33070130
Output File Names:
stability.trim.contigs.summary

It took 278 secs to summarize 33070130 sequences.



ScreenUniqueCountSummary.pbs
#!/bin/bash
#PBS -q standard_16
#PBS -l walltime=48:00:00
#PBS -l nodes=4:ppn=16
#PBS -j oe
#PBS -m e
#PBS -M cpkasanke@alaska.edu
cd $PBS_O_WORKDIR
module load mothur/1.35.1.nompi
mothur "#screen.seqs(fasta=stability.trim.contigs.fasta, group=stability.contigs.groups, maxambig=0, maxlength=275, processors=16); unique.seqs(fasta=stability.trim.contigs.good.fasta); count.seqs(name=stability.trim.contigs.good.names, group=stability.contigs.good.groups); summary.seqs(count=stability.trim.contigs.good.count_table)"

OUTPUT:  
Using 16 processors.

Output File Names:
stability.trim.contigs.good.fasta
stability.trim.contigs.bad.accnos
stability.contigs.good.groups


It took 1018 secs to screen 33070130 sequences.


mothur > unique.seqs(fasta=stability.trim.contigs.good.fasta)
24516196        4704712


Output File Names:
stability.trim.contigs.good.names
stability.trim.contigs.good.unique.fasta


mothur > count.seqs(name=stability.trim.contigs.good.names, group=stability.contigs.good.groups)

Using 16 processors.
It took 290 secs to create a table for 24516196 sequences.


Total number of sequences: 24516196

Output File Names:
stability.trim.contigs.good.count_table

mothur > summary.seqs(count=stability.trim.contigs.good.count_table)

Using stability.trim.contigs.good.unique.fasta as input file for the fasta parameter.

Using 16 processors.

                Start   End     NBases  Ambigs  Polymer NumSeqs
Minimum:        1       242     242     0       3       1
2.5%-tile:      1       252     252     0       3       612905
25%-tile:       1       253     253     0       4       6129050
Median:         1       253     253     0       5       12258099
75%-tile:       1       253     253     0       5       18387148
97.5%-tile:     1       254     254     0       6       23903292
Maximum:        1       275     275     0       47      24516196
Mean:   1       253.113 253.113 0       4.74696
# of unique seqs:       4704712
total # of seqs:        24516196

Output File Names:
stability.trim.contigs.good.unique.summary

It took 128 secs to summarize 24516196 sequences.

align.pbs
#!/bin/bash
#PBS -q standard_16
#PBS -l walltime=48:00:00
#PBS -l nodes=4:ppn=16
#PBS -j oe
#PBS -m e
#PBS -M cpkasanke@alaska.edu
cd $PBS_O_WORKDIR
module load mothur/1.35.1.nompi
mothur "#align.seqs(fasta=stability.trim.contigs.good.unique.fasta, reference=silva.seed_v119.align, flip=t, processors=16); summary.seqs(fasta=stability.trim.contigs.good.unique.align, count=stability.trim.contigs.good.count_table)"


Using 16 processors.

Reading in the silva.seed_v119.align template sequences...      DONE.
It took 38 to read  15009 sequences.
Aligning sequences from stability.trim.contigs.good.unique.fasta ...
Some of you sequences generated alignments that eliminated too many bases, a list is provided in stability.trim.contigs.good.unique.flip.accnos. If the reverse compliment proved to be better it was reported.
It took 9314 secs to align 4704712 sequences.


Output File Names:
stability.trim.contigs.good.unique.align
stability.trim.contigs.good.unique.align.report
stability.trim.contigs.good.unique.flip.accnos

screenseqs.pbs
#!/bin/bash
#PBS -q standard_16
#PBS -l walltime=48:00:00
#PBS -l nodes=4:ppn=16
#PBS -j oe
#PBS -m e
#PBS -M cpkasanke@alaska.edu
cd $PBS_O_WORKDIR
module load mothur/1.35.1.nompi
mothur "#screen.seqs(fasta=stability.trim.contigs.good.unique.align, count=stability.trim.contigs.good.count_table, summary=stability.trim.contigs.good.unique.summary, start=13862, end=23444, maxhomop=8, processors=32); filter.seqs(fasta=stability.trim.contigs.good.unique.good.align, vertical=T, trump=.)"


Using 32 processors.

Output File Names:
stability.trim.contigs.good.unique.good.summary
stability.trim.contigs.good.unique.good.align
stability.trim.contigs.good.unique.bad.accnos
stability.trim.contigs.good.good.count_table


Using 32 processors.
Creating Filter...


Running Filter...



Length of filtered alignment: 687
Number of columns removed: 49313
Length of the original alignment: 50000
Number of sequences used to construct filter: 4633459

Output File Names:
stability.filter
stability.trim.contigs.good.unique.good.filter.fasta

uniqueprecluster.pbs
#!/bin/bash
#PBS -q standard_16
#PBS -l walltime=48:00:00
#PBS -l nodes=4:ppn=16
#PBS -j oe
#PBS -m e
#PBS -M cpkasanke@alaska.edu
cd $PBS_O_WORKDIR
module load mothur/1.35.1.nompi
mothur "#unique.seqs(fasta=stability.trim.contigs.good.unique.good.filter.fasta, count=stability.trim.contigs.good.good.count_table)"

mothur > unique.seqs(fasta=stability.trim.contigs.good.unique.good.filter.fasta, count=stability.trim.contigs.good.good.count_table)
4633459 4631041

Output File Names:
stability.trim.contigs.good.unique.good.filter.count_table
stability.trim.contigs.good.unique.good.filter.unique.fasta

prefilter.pbs
#!/bin/bash
#PBS -q standard_16
#PBS -l walltime=48:00:00
#PBS -l nodes=4:ppn=16
#PBS -j oe
#PBS -m e
#PBS -M cpkasanke@alaska.edu
cd $PBS_O_WORKDIR
module load mothur/1.35.1.nompi
mothur "#pre.cluster(fasta=stability.trim.contigs.good.unique.good.filter.unique.fasta, count=stability.trim.contigs.good.unique.good.filter.count_table, diffs=2, processors=32)"


Cant use more than one node due to internal computer reasons. Trying to run it on the Bio nodes and got code from Oralee
Note:  Still only using one node from #PBS -l nodes=1:ppn=32, but the bio nodes still allow me to use 32 processors.  If I used one node on the standard_16 I can only use 16 processors.

Bioprefilter.pbs
#!/bin/bash
#PBS -q bio
#PBS -l walltime=48:00:00
#PBS -l nodes=1:ppn=32
#PBS -j oe
#PBS -m e
#PBS -M cpkasanke@alaska.edu
cd $PBS_O_WORKDIR
module load mothur/1.35.1.nompi
mothur "#pre.cluster(fasta=stability.trim.contigs.good.unique.good.filter.unique.fasta, count=stability.trim.contigs.good.unique.good.filter.count_table, diffs=2, processors=32)"


Output File Names:
stability.trim.contigs.good.unique.good.filter.unique.precluster.fasta
stability.trim.contigs.good.unique.good.filter.unique.precluster.count_table
stability.trim.contigs.good.unique.good.filter.unique.precluster.1_11_Final.map
stability.trim.contigs.good.unique.good.filter.unique.precluster.1_16_Final.map
stability.trim.contigs.good.unique.good.filter.unique.precluster.1_2_Final.map
stability.trim.contigs.good.unique.good.filter.unique.precluster.1_9_Final.map
stability.trim.contigs.good.unique.good.filter.unique.precluster.3_17_Final.map
stability.trim.contigs.good.unique.good.filter.unique.precluster.3_18_Final.map
stability.trim.contigs.good.unique.good.filter.unique.precluster.3_19_Final.map
stability.trim.contigs.good.unique.good.filter.unique.precluster.3_1_Final.map
.....and many more .map files (one for every sample (221))

splitabund.pbs
#!/bin/bash
#PBS -q bio
#PBS -l walltime=48:00:00
#PBS -l nodes=1:ppn=32
#PBS -j oe
#PBS -m e
#PBS -M cpkasanke@alaska.edu
cd $PBS_O_WORKDIR
module load mothur/1.35.1.nompi
mothur "#split.abund(fasta=stability.trim.contigs.good.unique.good.filter.unique.precluster.fasta, count=stability.trim.contigs.good.unique.good.filter.unique.precluster.count_table, cutoff=1, accnos=true)"

Output File Names:
stability.trim.contigs.good.unique.good.filter.unique.precluster.rare.count_table
stability.trim.contigs.good.unique.good.filter.unique.precluster.abund.count_table
rare.accnos
abund.accnos
stability.trim.contigs.good.unique.good.filter.unique.precluster.rare.fasta
stability.trim.contigs.good.unique.good.filter.unique.precluster.abund.fasta

chimera.pbs
#!/bin/bash
#PBS -q bio
#PBS -l walltime=48:00:00
#PBS -l nodes=1:ppn=32
#PBS -j oe
#PBS -m e
#PBS -M cpkasanke@alaska.edu
cd $PBS_O_WORKDIR
module load mothur/1.35.1.nompi
mothur "#chimera.uchime(fasta=stability.trim.contigs.good.unique.good.filter.unique.precluster.abund.fasta, count=stability.trim.contigs.good.unique.good.filter.unique.precluster.abund.count_table, dereplicate=t, processors=32)"

Output File Names:
stability.trim.contigs.good.unique.good.filter.unique.precluster.abund.uchime.pick.count_table
stability.trim.contigs.good.unique.good.filter.unique.precluster.abund.uchime.chimeras
stability.trim.contigs.good.unique.good.filter.unique.precluster.abund.uchime.accnos

Note:  Above the Output File Names was the output below:
It took 1043 secs to check 14682 sequences from group MW_156A_15ft_14.

It took 8 secs to check 715 sequences from group MW_156B_50ft_14.

It took 1 secs to check 142 sequences from group MW_159A_15ft_13.  *****WTF Only 142 sequences?! or only 142 sequences removed?

It took 1 secs to check 181 sequences from group MW_159C_70ft_13.

It took 127 secs to check 4369 sequences from group MW_161A_15ft_13.

It took 466 secs to check 9202 sequences from group PW_445657_14.

It took 489 secs to check 9457 sequences from group MW_304_15ft_13.

It took 1 secs to check 200 sequences from group MW_304_70ft_13.

It took 851 secs to check 12829 sequences from group PW_563579_14.

It took 1039 secs to check 13384 sequences from group MW_318_20ft_13.

IS THIS NORMAL!!??  GOING TO CONTINUE AND ASK LATER

remove.pbs
#!/bin/bash
#PBS -q bio
#PBS -l walltime=48:00:00
#PBS -l nodes=1:ppn=32
#PBS -j oe
#PBS -m e
#PBS -M cpkasanke@alaska.edu
cd $PBS_O_WORKDIR
module load mothur/1.35.1.nompi
mothur "#remove.seqs(fasta=stability.trim.contigs.good.unique.good.filter.unique.precluster.abund.fasta, accnos=stability.trim.contigs.good.unique.good.filter.unique.precluster.abund.uchime.accnos, dups=f)"

Removed 341782 sequences from your fasta file.

Output File Names:
stability.trim.contigs.good.unique.good.filter.unique.precluster.abund.pick.fasta

summary.pbs
#!/bin/bash
#PBS -q bio
#PBS -l walltime=48:00:00
#PBS -l nodes=1:ppn=32
#PBS -j oe
#PBS -m e
#PBS -M cpkasanke@alaska.edu
cd $PBS_O_WORKDIR
module load mothur/1.35.1.nompi
mothur "#summary.seqs(fasta=stability.trim.contigs.good.unique.good.filter.unique.precluster.abund.pick.fasta, count=stability.trim.contigs.good.unique.good.filter.unique.precluster.abund.count_table)"


Using 1 processors.

                Start   End     NBases  Ambigs  Polymer NumSeqs
Minimum:        1       686     218     0       3       1
2.5%-tile:      1       687     252     0       4       576618
25%-tile:       1       687     253     0       4       5766179
Median:         1       687     253     0       5       11532357
75%-tile:       1       687     253     0       6       17298535
97.5%-tile:     3       687     275     0       8       22488095
Maximum:        3       687     275     0       8       23064712
Mean:   0.94613 649.986 239.467 0       4.49021
# of unique seqs:       419055
total # of seqs:        23064712

Output File Names:
stability.trim.contigs.good.unique.good.filter.unique.precluster.abund.pick.summary

It took 48 secs to summarize 23064712 sequences.


Classify.pbs
#!/bin/bash
#PBS -q bio
#PBS -l walltime=48:00:00
#PBS -l nodes=1:ppn=32
#PBS -j oe
#PBS -m e
#PBS -M cpkasanke@alaska.edu
cd $PBS_O_WORKDIR
module load mothur/1.35.1.nompi
mothur "#classify.seqs(fasta=stability.trim.contigs.good.unique.good.filter.unique.precluster.abund.pick.fasta, count=stability.trim.contigs.good.unique.good.filter.unique.precluster.abund.uchime.pick.count_table, reference=silva.seed_v119.align, taxonomy=silva.seed_v119.tax, cutoff=80, processors=32)"

It took 331 secs to classify 419055 sequences.

It took 77 secs to create the summary file for 419055 sequences.

Output File Names:
stability.trim.contigs.good.unique.good.filter.unique.precluster.abund.pick.seed_v119.wang.taxonomy
stability.trim.contigs.good.unique.good.filter.unique.precluster.abund.pick.seed_v119.wang.tax.summary



#!/bin/bash
#PBS -q bio
#PBS -l walltime=48:00:00
#PBS -l nodes=1:ppn=32
#PBS -j oe
#PBS -m e
#PBS -M cpkasanke@alaska.edu
cd $PBS_O_WORKDIR
module load mothur/1.35.1.nompi
mothur "#remove.lineage(fasta=stability.trim.contigs.good.unique.good.filter.unique.precluster.abund.pick.fasta, count=stability.trim.contigs.good.unique.good.filter.unique.precluster.abund.uchime.pick.count_table, taxonomy=stability.trim.contigs.good.unique.good.filter.unique.precluster.abund.pick.seed_v119.wang.taxonomy, taxon=Chloroplast-Mitochondria-unknown-Eukaryota)"
[NOTE]: The count file should contain only unique names, so mothur assumes your fasta, list and taxonomy files also contain only uniques.


Output File Names:
stability.trim.contigs.good.unique.good.filter.unique.precluster.abund.pick.seed_v119.wang.pick.taxonomy
stability.trim.contigs.good.unique.good.filter.unique.precluster.abund.pick.pick.fasta
stability.trim.contigs.good.unique.good.filter.unique.precluster.abund.uchime.pick.pick.count_table

dist.pbs
#!/bin/bash
#PBS -q bio
#PBS -l walltime=48:00:00
#PBS -l nodes=1:ppn=32
#PBS -j oe
#PBS -m e
#PBS -M cpkasanke@alaska.edu
cd $PBS_O_WORKDIR
module load mothur/1.35.1.nompi
mothur "#dist.seqs(fasta=stability.trim.contigs.good.unique.good.filter.unique.precluster.abund.pick.pick.fasta, cutoff=0.20, processors=32)"


Using 32 processors.

Output File Names:
stability.trim.contigs.good.unique.good.filter.unique.precluster.abund.pick.pick.dist

It took 123797 seconds to calculate the distances for 401769 sequences.


#!/bin/bash
#PBS -q bio
#PBS -l walltime=720:00:00
#PBS -l nodes=1:ppn=32
#PBS -j oe
#PBS -m e
#PBS -M cpkasanke@alaska.edu
cd $PBS_O_WORKDIR
module load mothur/1.35.1.nompi
mothur "#cluster.split(fasta=stability.trim.contigs.good.unique.good.filter.unique.precluster.abund.pick.pick.fasta, count=stability.trim.contigs.good.unique.good.filter.unique.precluster.abund.uchime.pick.pick.count_table, taxonomy=stability.trim.contigs.good.unique.good.filter.unique.precluster.abund.pick.seed_v119.wang.pick.taxonomy, splitmethod=classify, taxlevel=4, cutoff=0.15, processors=32)"

Output File Names:
stability.trim.contigs.good.unique.good.filter.unique.precluster.abund.pick.pick.an.unique_list.list



makeshared.pbs
#!/bin/bash
#PBS -q bio
#PBS -l walltime=720:00:00
#PBS -l nodes=1:ppn=32
#PBS -j oe
#PBS -m e
#PBS -M cpkasanke@alaska.edu
cd $PBS_O_WORKDIR
module load mothur/1.35.1.nompi
mothur "#make.shared(list=stability.trim.contigs.good.unique.good.filter.unique.precluster.abund.pick.pick.an.unique_list.list, count=stability.trim.contigs.good.unique.good.filter.unique.precluster.abund.uchime.pick.pick.count_table, label=0.03)"
